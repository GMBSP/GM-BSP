<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Tower - Forums</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Verdana, Arial, Helvetica, sans-serif;
            background: #e5e5e5;
            color: #333;
            font-size: 12px;
        }

        /* Header */
        .header {
            background: #2d5a8f;
            border-bottom: 3px solid #1a3a5f;
            padding: 12px 0;
        }

        .header-content {
            max-width: 980px;
            margin: 0 auto;
            padding: 0 15px;
        }

        .logo {
            color: #fff;
            font-size: 24px;
            font-weight: bold;
        }

        .tagline {
            color: #b8d4ff;
            font-size: 11px;
            margin-top: 2px;
        }

        /* Navigation */
        .navbar {
            background: #3d6bb5;
            border-bottom: 1px solid #2d5a8f;
        }

        .nav-content {
            max-width: 980px;
            margin: 0 auto;
        }

        .nav-links {
            list-style: none;
            display: flex;
            margin: 0;
            padding: 0;
        }

        .nav-links li {
            border-right: 1px solid #2d5a8f;
        }

        .nav-links a {
            display: block;
            padding: 7px 14px;
            color: #fff;
            text-decoration: none;
            font-size: 11px;
        }

        .nav-links a:hover {
            background: #4d7bc5;
        }

        /* Container */
        .container {
            max-width: 980px;
            margin: 15px auto;
            background: #fff;
            border: 1px solid #bbb;
        }

        /* Breadcrumb */
        .breadcrumb {
            background: #f0f0f0;
            border-bottom: 1px solid #ccc;
            padding: 6px 12px;
            font-size: 11px;
        }

        .breadcrumb a {
            color: #2d5a8f;
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        /* Forum Header */
        .forum-header {
            background: #d0dce8;
            border-bottom: 1px solid #b0c0d0;
            padding: 8px 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .forum-title {
            font-size: 14px;
            font-weight: bold;
            color: #2d5a8f;
        }

        .server-tabs {
            display: flex;
            gap: 3px;
        }

        .server-tab {
            padding: 4px 10px;
            background: #fff;
            border: 1px solid #aaa;
            cursor: pointer;
            font-size: 11px;
        }

        .server-tab:hover {
            background: #f5f5f5;
        }

        .server-tab.active {
            background: #2d5a8f;
            color: #fff;
            border-color: #2d5a8f;
        }

        /* Thread List Table */
        .thread-list-table {
            width: 100%;
            border-collapse: collapse;
        }

        .thread-header-row {
            background: #e0e0e0;
            font-size: 11px;
            font-weight: bold;
            color: #555;
        }

        .thread-header-row th {
            padding: 6px 8px;
            text-align: left;
            border-bottom: 1px solid #ccc;
        }

        .thread-row {
            border-bottom: 1px solid #e0e0e0;
            cursor: pointer;
        }

        .thread-row:hover {
            background: #f8f8f8;
        }

        .thread-row td {
            padding: 8px;
            font-size: 11px;
        }

        .thread-icon {
            width: 40px;
            text-align: center;
            font-size: 20px;
        }

        .thread-title-col {
            font-weight: bold;
            color: #2d5a8f;
        }

        .thread-starter {
            font-size: 10px;
            color: #666;
            margin-top: 2px;
        }

        .thread-category {
            width: 100px;
            text-align: center;
        }

        .category-tag {
            display: inline-block;
            padding: 2px 6px;
            background: #2d5a8f;
            color: #fff;
            font-size: 9px;
            text-transform: uppercase;
        }

        .thread-replies-col {
            width: 70px;
            text-align: center;
        }

        .reply-count {
            font-weight: bold;
            color: #2d5a8f;
            font-size: 13px;
        }

        .thread-lastpost-col {
            width: 140px;
            font-size: 10px;
        }

        .lastpost-date {
            color: #666;
        }

        .lastpost-user {
            color: #2d5a8f;
            font-weight: bold;
        }

        .server-indicator {
            display: inline-block;
            padding: 1px 5px;
            font-size: 9px;
            font-weight: bold;
            margin-left: 5px;
        }

        .server-indicator.gmod {
            background: #5085d4;
            color: #fff;
        }

        .server-indicator.tf2 {
            background: #d9a441;
            color: #000;
        }

        .no-threads {
            padding: 30px;
            text-align: center;
            color: #999;
            font-style: italic;
        }

        /* Thread View */
        .thread-view {
            display: none;
            padding: 15px;
        }

        .thread-view.active {
            display: block;
        }

        .back-btn {
            display: inline-block;
            padding: 5px 10px;
            background: #e0e0e0;
            border: 1px solid #aaa;
            color: #333;
            text-decoration: none;
            font-size: 11px;
            margin-bottom: 12px;
            cursor: pointer;
        }

        .back-btn:hover {
            background: #d0d0d0;
        }

        .thread-post {
            border: 1px solid #ccc;
            margin-bottom: 12px;
        }

        .post-header {
            background: #e8e8e8;
            padding: 6px 10px;
            border-bottom: 1px solid #ccc;
            display: flex;
            justify-content: space-between;
            font-size: 11px;
        }

        .post-author {
            font-weight: bold;
            color: #2d5a8f;
        }

        .post-date {
            color: #666;
        }

        .post-content {
            padding: 12px;
            line-height: 1.5;
            white-space: pre-wrap;
        }

        /* Footer */
        .footer {
            background: #3d6bb5;
            color: #fff;
            padding: 12px 0;
            margin-top: 15px;
            border-top: 3px solid #2d5a8f;
        }

        .footer-content {
            max-width: 980px;
            margin: 0 auto;
            padding: 0 15px;
            font-size: 10px;
            text-align: center;
        }

        .footer-links {
            margin-bottom: 8px;
        }

        .footer-links a {
            color: #b8d4ff;
            text-decoration: none;
            margin: 0 8px;
        }

        .footer-links a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div class="logo">THE TOWER FORUMS</div>
            <div class="tagline">Community Discussion Board</div>
        </div>
    </div>

    <div class="navbar">
        <div class="nav-content">
            <ul class="nav-links">
                <li><a href="index">GM Tower Home</a></li>
                <li><a href="tf2tower">TF2 Tower Home</a></li>
                <li><a href="#">Forums</a></li>
                <li><a href="https://discord.gg/udE8zN5Gx7">Discord</a></li>
            </ul>
        </div>
    </div>

    <div class="container">
        <div class="breadcrumb">
            <a href="index">Home</a> &gt; <a href="#">Forums</a> &gt; <span id="currentBreadcrumb">All Discussions</span>
        </div>

        <!-- Thread List -->
        <div id="threadList">
            <div class="forum-header">
                <div class="forum-title" id="forumTitle">All Discussions</div>
                <div class="server-tabs">
                    <div class="server-tab active" onclick="filterThreads('all')" id="tabAll">All</div>
                    <div class="server-tab" onclick="filterThreads('gmod')" id="tabGmod">GM Tower</div>
                    <div class="server-tab" onclick="filterThreads('tf2')" id="tabTf2">TF2 Tower</div>
                </div>
            </div>

            <table class="thread-list-table">
                <tr class="thread-header-row">
                    <th width="40"></th>
                    <th>Thread / Thread Starter</th>
                    <th width="100">Category</th>
                    <th width="70">Replies</th>
                    <th width="140">Last Post</th>
                </tr>
                <tbody id="threadTableBody">
                    <!-- Threads loaded here -->
                </tbody>
            </table>
        </div>

        <!-- Thread View -->
        <div id="threadView" class="thread-view">
            <span class="back-btn" onclick="backToList()">‚Üê Back to Thread List</span>
            <div id="threadContent"></div>
        </div>
    </div>

    <div class="footer">
        <div class="footer-content">
            <div class="footer-links">
                <a href="index">GM Tower</a> |
                <a href="tf2tower">TF2 Tower</a> |
                <a href="https://discord.gg/udE8zN5Gx7">Discord</a>
            </div>
            <p>&copy; 2012-2016 The Tower Community</p>
        </div>
    </div>

    <script>
        let currentFilter = 'all';

        function initDefaults() {
            const gmodPosts = localStorage.getItem('gmod_forum_posts');
            const tf2Posts = localStorage.getItem('tf2_forum_posts');

            if (!gmodPosts || JSON.parse(gmodPosts).length === 0) {
                localStorage.setItem('gmod_forum_posts', JSON.stringify([
                    {
                        id: 1450137600000,
                        title: "The Weird Door in Construct",
                        date: "2015-12-15",
                        category: "news",
                        content: "Has anyone else noticed the mysterious door that appeared in construct? It doesn't open and makes strange sounds when you get close. Some players are saying it's part of an ARG. What do you think?",
                        server: "gmod",
                        author: "mysterious_steve",
                        replies: 47
                    },
                    {
                        id: 1452441600000,
                        title: "Sandbox Build Competition This Weekend!",
                        date: "2016-01-10",
                        category: "event",
                        content: "Build Competition Alert!\n\nThis Saturday at 3 PM EST, we're hosting our monthly build competition!\n\nTheme: \"Futuristic City\"\nPrizes: Custom player models and VIP status\nTime limit: 2 hours\n\nSign up in Discord!",
                        server: "gmod",
                        author: "AdminJake",
                        replies: 23
                    },
                    {
                        id: 1453132800000,
                        title: "New TTT Maps Added",
                        date: "2016-01-18",
                        category: "update",
                        content: "We've added 3 new TTT maps to the rotation:\n\n- ttt_minecraft_b5\n- ttt_clue_se\n- ttt_rooftops_a2_1\n\nCheck them out and let us know what you think!",
                        server: "gmod",
                        author: "ModSarah",
                        replies: 12
                    }
                ]));
            }

            if (!tf2Posts || JSON.parse(tf2Posts).length === 0) {
                localStorage.setItem('tf2_forum_posts', JSON.stringify([
                    {
                        id: 1452825600000,
                        title: "Welcome to The TF2 Tower!",
                        date: "2016-01-15",
                        category: "announcement",
                        content: "Welcome to our TF2 community server!\n\nWe're a friendly server focused on classic TF2 gameplay. No random crits, no ads, just pure fun.\n\nJoin our Discord and say hi!",
                        server: "tf2",
                        author: "TF2Admin",
                        replies: 31
                    },
                    {
                        id: 1453420800000,
                        title: "New Map Rotation - January 2016",
                        date: "2016-01-22",
                        category: "update",
                        content: "Updated map rotation!\n\nPayload:\n- pl_upward\n- pl_badwater\n- pl_barnblitz\n\nKOTH:\n- koth_harvest\n- koth_viaduct\n- koth_lakeside\n\nVote for next week's maps in Discord!",
                        server: "tf2",
                        author: "MapMaster",
                        replies: 18
                    }
                ]));
            }
        }

        function filterThreads(filter) {
            currentFilter = filter;

            document.getElementById('tabAll').classList.remove('active');
            document.getElementById('tabGmod').classList.remove('active');
            document.getElementById('tabTf2').classList.remove('active');

            if (filter === 'all') {
                document.getElementById('tabAll').classList.add('active');
                document.getElementById('forumTitle').textContent = 'All Discussions';
                document.getElementById('currentBreadcrumb').textContent = 'All Discussions';
            } else if (filter === 'gmod') {
                document.getElementById('tabGmod').classList.add('active');
                document.getElementById('forumTitle').textContent = 'GM Tower Forums';
                document.getElementById('currentBreadcrumb').textContent = 'GM Tower';
            } else {
                document.getElementById('tabTf2').classList.add('active');
                document.getElementById('forumTitle').textContent = 'TF2 Tower Forums';
                document.getElementById('currentBreadcrumb').textContent = 'TF2 Tower';
            }

            loadThreads();
        }

        function loadThreads() {
            const gmodPosts = JSON.parse(localStorage.getItem('gmod_forum_posts') || '[]');
            const tf2Posts = JSON.parse(localStorage.getItem('tf2_forum_posts') || '[]');

            let posts = [];
            if (currentFilter === 'gmod') {
                posts = gmodPosts.map(p => ({...p, server: 'gmod'}));
            } else if (currentFilter === 'tf2') {
                posts = tf2Posts.map(p => ({...p, server: 'tf2'}));
            } else {
                posts = [...gmodPosts.map(p => ({...p, server: 'gmod'})), ...tf2Posts.map(p => ({...p, server: 'tf2'}))];
            }

            const tbody = document.getElementById('threadTableBody');

            if (posts.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="no-threads">No threads yet. Check back soon!</td></tr>';
                return;
            }

            posts.sort((a, b) => new Date(b.date) - new Date(a.date));

            const icons = {
                announcement: 'üì¢',
                update: 'üîÑ',
                event: 'üéâ',
                maintenance: 'üîß',
                news: 'üì∞'
            };

            let html = '';
            posts.forEach(post => {
                const icon = icons[post.category] || 'üìã';
                const date = new Date(post.date).toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
                const serverTag = currentFilter === 'all' ? `<span class="server-indicator ${post.server}">${post.server === 'gmod' ? 'GMOD' : 'TF2'}</span>` : '';

                html += `
                    <tr class="thread-row" onclick="viewThread(${post.id}, '${post.server}')">
                        <td class="thread-icon">${icon}</td>
                        <td>
                            <div class="thread-title-col">${post.title}${serverTag}</div>
                            <div class="thread-starter">by <strong>${post.author || 'Anonymous'}</strong>, ${date}</div>
                        </td>
                        <td class="thread-category">
                            <span class="category-tag">${post.category}</span>
                        </td>
                        <td class="thread-replies-col">
                            <div class="reply-count">${post.replies || 0}</div>
                        </td>
                        <td class="thread-lastpost-col">
                            <div class="lastpost-date">${date}</div>
                            <div class="lastpost-user">by ${post.author || 'Anonymous'}</div>
                        </td>
                    </tr>
                `;
            });

            tbody.innerHTML = html;
        }

        function viewThread(id, server) {
            const key = server === 'gmod' ? 'gmod_forum_posts' : 'tf2_forum_posts';
            const posts = JSON.parse(localStorage.getItem(key) || '[]');
            const post = posts.find(p => p.id === id);

            if (!post) return;

            const date = new Date(post.date).toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });

            document.getElementById('threadContent').innerHTML = `
                <h2 style="color: #2d5a8f; margin-bottom: 12px; font-size: 16px;">${post.title}</h2>
                <div class="thread-post">
                    <div class="post-header">
                        <span class="post-author">${post.author || 'Anonymous'}</span>
                        <span class="post-date">${date}</span>
                    </div>
                    <div class="post-content">${post.content}</div>
                </div>
            `;

            document.getElementById('threadList').style.display = 'none';
            document.getElementById('threadView').classList.add('active');
        }

        function backToList() {
            document.getElementById('threadList').style.display = 'block';
            document.getElementById('threadView').classList.remove('active');
        }

        initDefaults();
        loadThreads();
    </script>
</body>
</html>
